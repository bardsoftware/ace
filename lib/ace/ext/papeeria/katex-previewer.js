// Generated by CoffeeScript 1.10.0
(function() {
  define(function(require, exports, module) {
    exports.setupPreviewer = function(editor) {
      var initKaTeX, katex, katexInitialized;
      require("ace/ext/jquery");
      katexInitialized = false;
      katex = {};
      initKaTeX = function() {
        var cssDemoPath, cssKatexPath, linkDemo, linkKatex, span;
        cssKatexPath = require.toUrl("../katex/katex.min.css");
        linkKatex = $("<link>").attr("rel", "stylesheet").attr("href", cssKatexPath);
        $("head").append(linkKatex);
        cssDemoPath = require.toUrl("./katex-demo.css");
        linkDemo = $("<link>").attr("rel", "stylesheet").attr("href", cssDemoPath);
        $("head").append(linkDemo);
        span = $("<span>").attr("id", "formula");
        $("body").append(span);
        katex = require("ace/ext/katex");
        katexInitialized = true;
      };
      return editor.commands.addCommand({
        name: "previewLaTeXFormula",
        bindKey: {
          win: "Alt-p",
          mac: "Alt-p"
        },
        exec: function(editor) {
          var selectedText;
          if (!katexInitialized) {
            initKaTeX();
          }
          selectedText = editor.getSelectedText();
          katex.render(selectedText, $("#formula")[0]);
        }
      });
    };
  });

}).call(this);
