// Generated by CoffeeScript 1.12.3
(function() {
  var foo;

  foo = null;

  define(function(require, exports, module) {
    var ENVIRONMENT_STATE, ENVIRONMENT_TOKENTYPE, EQUATION_STATE, EQUATION_TOKENTYPE, FIGURE_STATE, FIGURE_TOKENTYPE, LIST_STATE, LIST_TOKENTYPE, PapeeriaLatexHighlightRules, STATES, TABLE_STATE, TABLE_TOKENTYPE, TOKEN_TYPES, getContext, getContextFromRow, isType;
    PapeeriaLatexHighlightRules = require("ace/ext/papeeria/papeeria_latex_highlight_rules");
    EQUATION_STATE = PapeeriaLatexHighlightRules.EQUATION_STATE;
    LIST_STATE = PapeeriaLatexHighlightRules.LIST_STATE;
    ENVIRONMENT_STATE = PapeeriaLatexHighlightRules.ENVIRONMENT_STATE;
    TABLE_STATE = PapeeriaLatexHighlightRules.TABLE_STATE;
    FIGURE_STATE = PapeeriaLatexHighlightRules.FIGURE_STATE;
    EQUATION_TOKENTYPE = PapeeriaLatexHighlightRules.EQUATION_TOKENTYPE;
    LIST_TOKENTYPE = PapeeriaLatexHighlightRules.LIST_TOKENTYPE;
    ENVIRONMENT_TOKENTYPE = PapeeriaLatexHighlightRules.ENVIRONMENT_TOKENTYPE;
    FIGURE_TOKENTYPE = PapeeriaLatexHighlightRules.FIGURE_TOKENTYPE;
    TABLE_TOKENTYPE = PapeeriaLatexHighlightRules.TABLE_TOKENTYPE;
    TOKEN_TYPES = [EQUATION_TOKENTYPE, LIST_TOKENTYPE, FIGURE_TOKENTYPE, ENVIRONMENT_TOKENTYPE, TABLE_TOKENTYPE];
    STATES = [EQUATION_STATE, LIST_STATE, FIGURE_STATE, ENVIRONMENT_STATE, TABLE_STATE];
    isType = function(token, type) {
      return token.type.split(".").indexOf(type) > -1;
    };

    /*
     * @param {(number, number) pos}
     *
     * Returns context at cursor position.
     */
    getContext = function(session, row, column) {
      var i, j, ref, state, token;
      state = getContextFromRow(session, row);
      token = session.getTokenAt(row, column);
      if (token != null) {
        for (i = j = 0, ref = TOKEN_TYPES.length - 1; 0 <= ref ? j <= ref : j >= ref; i = 0 <= ref ? ++j : --j) {
          if (isType(token, TOKEN_TYPES[i])) {
            return STATES[i];
          }
        }
      }
      return state;
    };
    getContextFromRow = function(session, row) {
      var states;
      states = session.getState(row);
      if (Array.isArray(states)) {
        return states[states.length - 1];
      } else {
        return states;
      }
    };
    exports.getContext = getContext;
    exports.isType = isType;
  });

}).call(this);
